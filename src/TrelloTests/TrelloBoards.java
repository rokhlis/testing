package TrelloTests;

import org.openqa.selenium.By;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;
import pages.BoardsPageHelper;
import pages.CurrentBoardHelper;
import pages.LoginPageHelper;

public class TrelloBoards extends TestBase {
    LoginPageHelper loginPage;
    BoardsPageHelper boardsPage;
    CurrentBoardHelper currentBoard;

    @BeforeMethod
    public void initTests() {
        loginPage = new LoginPageHelper(driver);
        boardsPage = new BoardsPageHelper(driver);
        currentBoard = new CurrentBoardHelper(driver);

        loginPage.openLoginPage();
        loginPage.enteringCredentialsAndClickingLogin(LOGIN,PASSWORD);
        currentBoard.enterWorkspace(WORKSPACE_NAME);
        currentBoard.openCurrentBoard(BOARD_TITLE);
    }

    @Test
    public void trelloAddNewList() {
        currentBoard.checkQuantityOfLists();
//        //Checking quantity of lists
//        System.out.println("Quantity of Lists: " + driver.findElements(By.className("js-list")).size());
        //Adding new List
        driver.findElement(By.xpath("//div[@class='js-add-list list-wrapper mod-add is-idle']//span[@class='placeholder']")).click();
        waitUntilElementIsVisible((By.xpath("//input[@class='primary mod-list-add-button js-save-edit']")), 20);
        //Entering new List name
        driver.findElement(By.name("name")).sendKeys("AutoGeneratedList");
        waitUntilElementIsClickable(By.xpath("//input[@class='primary mod-list-add-button js-save-edit']"), 20);
        //Adding new List with entered name
        driver.findElement(By.xpath("//input[@class='primary mod-list-add-button js-save-edit']")).click();
        //Canceling other List adding
        waitUntilElementIsVisible((By.xpath("//a[@class='icon-lg icon-close dark-hover js-cancel-edit']")), 20);
        driver.findElement(By.xpath("//a[@class='icon-lg icon-close dark-hover js-cancel-edit']")).click();
        currentBoard.checkQuantityOfLists();
//        //Checking quantity of lists
//        System.out.println("Quantity of Lists: " + driver.findElements(By.className("js-list")).size());
    }

    @Test
    public void trelloAddNewCard() {
        //Checking if any Lists exists on the board
        if ((driver.findElements(By.className("js-list")).size()) == 0) {
            //Adding new List
            driver.findElement(By.xpath("//div[@class='js-add-list list-wrapper mod-add is-idle']//span[@class='placeholder']")).click();
            waitUntilElementIsVisible((By.xpath("//input[@class='primary mod-list-add-button js-save-edit']")), 20);
            //Naming new List
            driver.findElement(By.name("name")).sendKeys("AutoGeneratedList");
            waitUntilElementIsClickable(By.xpath("//input[@class='primary mod-list-add-button js-save-edit']"), 20);
            //Adding newly named List
            driver.findElement(By.xpath("//input[@class='primary mod-list-add-button js-save-edit']")).click();
            //Canceling other List adding
            waitUntilElementIsVisible((By.xpath("//a[@class='icon-lg icon-close dark-hover js-cancel-edit']")), 20);
            driver.findElement(By.xpath("//a[@class='icon-lg icon-close dark-hover js-cancel-edit']")).click();
        }
        //Counting Cards
        System.out.println("Quantity of Cards: " + driver.findElements(By.className("js-card-name")).size());
        //Opening card composer
        driver.findElement(By.className("js-open-card-composer")).click();
        waitUntilElementIsVisible((By.className("js-add-card")), 20);
        //Entering card name
        driver.findElement(By.xpath("//textarea[@placeholder='Enter a title for this cardâ€¦']")).sendKeys("AutoGeneratedCard");
        waitUntilElementIsClickable((By.className("primary confirm mod-compact js-add-card")), 10);
        //Adding card to the llist
        driver.findElement(By.xpath("//input[@class='primary confirm mod-compact js-add-card']")).click();
        //Counting Cards
        System.out.println("Quantity of Cards: " + driver.findElements(By.className("js-card-name")).size());
    }

}
